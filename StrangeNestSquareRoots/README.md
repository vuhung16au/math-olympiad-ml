See here: https://github.com/vuhung16au/MachineLearning-GenAI/tree/main/StrangeNestSquareRoots

## Python Simulation Script

This project includes a Python script to simulate the density of the sequence generated by the recurrence relation $x_{k+1} = 2x_k\sqrt{1 - x_k^2}$ with initial condition $x_0 \in [0,1]$.

### Prerequisites

- Python 3.9
- pip (Python package installer)

### Setup Virtual Environment

1. Create a virtual environment in the project root:
   ```bash
   python3.9 -m venv .venv
   ```

2. Activate the virtual environment:
   - On macOS/Linux:
     ```bash
     source .venv/bin/activate
     ```
   - On Windows:
     ```bash
     .venv\Scripts\activate
     ```

3. Install required packages:
   ```bash
   pip install numpy matplotlib
   ```

   Alternatively, if you have a requirements.txt file:
   ```bash
   pip install -r requirements.txt
   ```

### Running the Script

1. Ensure the virtual environment is activated (see above).

2. Run the simulation script:
   ```bash
   python StrangeNestSquareRoots.py
   ```

   The script will:
   - Generate a sequence of 100,000 iterations starting from $x_0 = \frac{3}{4}$
   - Compute the empirical density using a histogram
   - Compare it with the theoretical invariant density $p(x) = \frac{2}{\pi\sqrt{1-x^2}}$
   - Save the results to `./data/density_0.75.txt`
   - Generate density plots (PNG and PDF) in the same directory

### Output Files

After running the script, you will find the following output files in `./data/`:

- `density_0.75.txt`: Text file containing:
  - Column 1: x (bin center)
  - Column 2: Empirical density
  - Column 3: Theoretical density
  
- `density_0.75.png`: High-resolution PNG image of the density plot
- `density_0.75.pdf`: PDF version of the density plot (used in LaTeX document)

### Viewing Results

The script prints summary statistics to the console, including:
- Minimum and maximum sequence values
- Mean value
- Number of valid values

To view the generated plots, simply open the PNG or PDF files in any image viewer or PDF reader.

### Deactivating the Virtual Environment

When you're done working, deactivate the virtual environment:
```bash
deactivate
```

### Questions Addressed

The simulation helps answer:
- **How dense the sequence is?** The empirical density shows how the sequence values are distributed across the interval [0, 1].
- **How does the density change as the initial condition changes?** By modifying the `x0` parameter in the script, you can explore how different initial conditions affect the empirical distribution.

### Integration with LaTeX Document

The generated PDF plot is automatically included in the LaTeX document (`StrangeNestSquareRoots.tex`) in the "Numerical Verification" subsection of "The Invariant Measure" section. After running the script, rebuild the PDF document using:

```bash
make pdf
```